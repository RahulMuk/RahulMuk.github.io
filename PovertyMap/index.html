<!DOCTYPE html>
<html>
    <head>
        <title>Poverty in Athens County</title>
    
        <meta charset="utf-8" />
        <link rel="stylesheet" href="css/leaflet.css" />
        <link rel="stylesheet" href="css/MarkerCluster.css" />
        <link rel="stylesheet" href="css/MarkerCluster.Default.css" />
        <link rel="stylesheet" type="text/css" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/label.css" />
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/label.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/leaflet.markercluster.js"></script>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    </head>
    <body>
        <div id="map"></div>
        <script src="data/json_HSGrad.js"></script>
        <script src="data/json_Income.js"></script>
        <script src="data/json_FoodStamps.js"></script>
        <script src="data/json_College.js"></script>
        <script src="data/json_Poverty.js"></script>
        <script>
        var highlightLayer;
        function highlightFeature(e) {
            highlightLayer = e.target;
            highlightLayer.openPopup();
        }
        var map = L.map('map', {
            zoomControl:true, maxZoom:28, minZoom:1
        }).fitBounds([[40.5195282328,-66.1563048456],[41.7175698614,-62.6895590556]]);
        var hash = new L.Hash(map);
        var additional_attrib = '<a href="https://github.com/tomchadwin/qgis2web" target ="_blank">qgis2web</a>';
        var feature_group = new L.featureGroup([]);
        var bounds_group = new L.featureGroup([]);
        var raster_group = new L.LayerGroup([]);
        var layerOrder = new Array();
        function restackLayers() {
            for (index = 0; index < layerOrder.length; index++) {
                layerOrder[index].bringToFront();
            }
        }
        map.on('overlayadd', restackLayers);
        layerControl = L.control.layers({},{},{collapsed:false});
            
        function pop_Poverty(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){feature.closePopup()});
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table><tr><th scope="row">Township Name:</th><td>' + Autolinker.link(String(feature.properties['TOWNSHIP_N'])) + '</td></tr><tr><th scope="row">Households in Poverty:</th><td>' + Autolinker.link(String(feature.properties['Poverty'])) + '%</td></tr></table>';
            layer.bindPopup(popupContent);
        }

        function doStylePoverty(feature) {
        if (feature.properties.Poverty >= 9.2 && feature.properties.Poverty <= 16.875) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#f7fbff',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Poverty >= 16.875 && feature.properties.Poverty <= 24.55) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#afd1e7',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Poverty >= 24.55 && feature.properties.Poverty <= 32.225) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#3d8dc3',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Poverty >= 32.225 && feature.properties.Poverty <= 39.9) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#08306b',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        }
            var json_PovertyJSON = new L.geoJson(json_Poverty, {
                onEachFeature: pop_Poverty,
                style: doStylePoverty
            });
            layerOrder[layerOrder.length] = json_PovertyJSON;
        bounds_group.addLayer(json_PovertyJSON);
        feature_group.addLayer(json_PovertyJSON);
            
        function pop_College(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){feature.closePopup()});
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table><tr><th scope="row">Township Name:</th><td>' + Autolinker.link(String(feature.properties['TOWNSHIP_N']))+ '</td></tr><tr><th scope="row">Adults over 25 with a Bachleors Degrees:</th><td>' + Autolinker.link(String(feature.properties['College']))+'%</td></tr></table>';
            layer.bindPopup(popupContent);
        }

        function doStyleCollege(feature) {
        if (feature.properties.College >= 4.1 && feature.properties.College <= 15.95) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#fcfbfd',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.College >= 15.95 && feature.properties.College <= 27.8) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#c9c9e2',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.College >= 27.8 && feature.properties.College <= 39.65) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#7c75b6',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.College >= 39.65 && feature.properties.College <= 51.5) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#3f007d',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        }
            var json_CollegeJSON = new L.geoJson(json_College, {
                onEachFeature: pop_College,
                style: doStyleCollege
            });
            layerOrder[layerOrder.length] = json_CollegeJSON;
        bounds_group.addLayer(json_CollegeJSON);
       // feature_group.addLayer(json_CollegeJSON);
            
        function pop_FoodStamps(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){feature.closePopup()});
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table><tr><th scope="row">Township Name:</th><td>' + Autolinker.link(String(feature.properties['TOWNSHIP_N'])) + '</td></tr><tr><th scope="row">Households with Food Stamps:</th><td>' + Autolinker.link(String(feature.properties['FoodStamp'])) + '%</td></tr></table>';
            layer.bindPopup(popupContent);
        }

        function doStyleFoodStamps(feature) {
        if (feature.properties.FoodStamp >= 8.6 && feature.properties.FoodStamp <= 15.0) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#fff5eb',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.FoodStamp >= 15.0 && feature.properties.FoodStamp <= 21.4) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#fdbc82',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.FoodStamp >= 21.4 && feature.properties.FoodStamp <= 27.8) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#ed6410',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.FoodStamp >= 27.8 && feature.properties.FoodStamp <= 34.2) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#7f2704',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        }
            var json_FoodStampsJSON = new L.geoJson(json_FoodStamps, {
                onEachFeature: pop_FoodStamps,
                style: doStyleFoodStamps
            });
            layerOrder[layerOrder.length] = json_FoodStampsJSON;
        bounds_group.addLayer(json_FoodStampsJSON);
        //feature_group.addLayer(json_FoodStampsJSON);
            
        function pop_Income(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){feature.closePopup()});
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table><tr><th scope="row">Township Name:</th><td>' + Autolinker.link(String(feature.properties['TOWNSHIP_N']))+'</td></tr><tr><th scope="row">Average Income:</th><td>$' + Autolinker.link(String(feature.properties['Income'])) +'</td></tr></table>';
            layer.bindPopup(popupContent);
        }

        function doStyleIncome(feature) {
        if (feature.properties.Income >= 26800.0 && feature.properties.Income <= 32925.0) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#f7fcf5',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Income >= 32925.0 && feature.properties.Income <= 39050.0) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#b1dfab',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Income >= 39050.0 && feature.properties.Income <= 45175.0) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#3da659',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.Income >= 45175.0 && feature.properties.Income <= 51300.0) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#00441b',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        }
            var json_IncomeJSON = new L.geoJson(json_Income, {
                onEachFeature: pop_Income,
                style: doStyleIncome
            });
            layerOrder[layerOrder.length] = json_IncomeJSON;
        bounds_group.addLayer(json_IncomeJSON);
        //feature_group.addLayer(json_IncomeJSON);

        function pop_HSGrad(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){feature.closePopup()});
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table><tr><th scope="row">Township Name:</th><td>' + Autolinker.link(String(feature.properties['TOWNSHIP_N'])) + '</td></tr><tr><th scope="row">High School Graduation Rate:</th><td>' + Autolinker.link(String(feature.properties['HSgrad'])) + '%</td></tr></table>';
            layer.bindPopup(popupContent);
        }

        function doStyleHSGrad(feature) {
        if (feature.properties.HSgrad >= 72.7 && feature.properties.HSgrad <= 77.325) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#fff5f0',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.HSgrad >= 77.325 && feature.properties.HSgrad <= 81.95) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#fca386',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.HSgrad >= 81.95 && feature.properties.HSgrad <= 86.575) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#ea362a',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        if (feature.properties.HSgrad >= 86.575 && feature.properties.HSgrad <= 91.2) {
            return {
                color: '#000000',
                weight: '1.04',
                dashArray: '',
                fillColor: '#67000d',
                opacity: '1.0',
                fillOpacity: '1.0',
            }
        }
        }
            var json_HSGradJSON = new L.geoJson(json_HSGrad, {
                onEachFeature: pop_HSGrad,
                style: doStyleHSGrad
            });
            layerOrder[layerOrder.length] = json_HSGradJSON;
        bounds_group.addLayer(json_HSGradJSON);
        //feature_group.addLayer(json_HSGradJSON);
            
        raster_group.addTo(map);
        feature_group.addTo(map);
        var title = new L.Control();
		title.onAdd = function (map) {
			this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
			this.update();
			return this._div;
		};
		title.update = function () {
			this._div.innerHTML = '<h2>Poverty Rate in Athens</h2>Various metrics showing poverty in Athens'
		};
		title.addTo(map);
        var baseMaps = {};
            L.control.layers({},{'Households in Poverty (%)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Poverty_92169.png" />  9.20% - 16.90% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Poverty_169246.png" />  16.90% - 24.60% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Poverty_246322.png" />  24.60% - 32.20% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Poverty_322399.png" />  32.20% - 39.90% <br />': json_PovertyJSON,'Adults over 25 with a Bachelors Degree (%)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/College_41000159500.png" />  4.10% - 15.95% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/College_159500278000.png" />  15.95% - 27.80% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/College_278000396500.png" />  27.80% - 39.65% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/College_396500515000.png" />  39.65% - 51.50% <br />': json_CollegeJSON,'Households with Food Stamps (%)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/FoodStamps_86000150000.png" />  8.60% - 15.00% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/FoodStamps_150000214000.png" />  15.00% - 21.40% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/FoodStamps_214000278000.png" />  21.40% - 27.80% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/FoodStamps_278000342000.png" />  27.80% - 34.20% <br />': json_FoodStampsJSON,'Average Income ($)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Income_268000000329250000.png" />  $26,800 - $32,925 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Income_329250000390500000.png" />  $32,925 - $39,050 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Income_390500000451750000.png" />  $39,050 - $45,175 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/Income_451750000513000000.png" />  $45,175 - $51,300 <br />': json_IncomeJSON,'High School Graduation Rate (%)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/HSGrad_727000773250.png" />  72.70% - 77.33% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/HSGrad_773250819500.png" />  77.33% - 81.95% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/HSGrad_819500865750.png" />  81.95% - 86.58% <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="legend/HSGrad_865750912000.png" />  86.58% - 91.20% <br />': json_HSGradJSON},{collapsed:false}).addTo(map);
        L.control.scale({options: {position: 'bottomleft',maxWidth: 100,metric: true,imperial: false,updateWhenIdle: false}}).addTo(map);
    </script>
</body>
</html>