<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Parallel Chart</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      /* Add your CSS styles here */
      .line {
        fill: none;
        stroke-width: 2;
        cursor: pointer;
        opacity: ;
      }

      .axis line, .axis text, g.tick {
        opacity: 1;
        /* display: none; Hide tick marks and axis lines */

      }

      g.tick > line {
        stroke: #afafaf;
      }

      text.currentColor {
        font-size: 24px;
      }

      .hover-text {
        font-size: 12px;
        text-anchor: middle;
      }


      

    </style>
  </head>
  <body>
    <div id="shein"></div>
    <script>
      // Data for your parallel coordinates chart
      const data = [
  {
    name: "Australia",
    attr1: 1855232,
    attr2: 3092311,
  },
  {
    name: "Brazil",
    attr1: 32480654,
    attr2: 56415978,
  },
  {
    name: "Canada",
    attr1: 2801779,
    attr2: 4276864,
  },
  {
    name: "France",
    attr1: 5993318,
    attr2: 9769148,
  },
  {
    name: "Germany",
    attr1: 3286129,
    attr2: 6317754,
  },
  {
    name: "Italy",
    attr1: 5554559,
    attr2: 9578952,
  },
  {
    name: "Japan",
    attr1: 6337257,
    attr2: 10260293,
  },
  {
    name: "Mexico",
    attr1: 16254510,
    attr2: 23579810,
  },
  {
    name: "Philippines",
    attr1: 4608469,
    attr2: 7945641,
  },
  {
    name: "Poland",
    attr1: 2540966,
    attr2: 3950981,
  },
  {
    name: "Saudi Arabia",
    attr1: 5001157,
    attr2: 7818531,
  },
  {
    name: "South Africa",
    attr1: 2631038,
    attr2: 5490886,
  },
  {
    name: "Spain",
    attr1: 6617938,
    attr2: 11100156,
  },
  {
    name: "United Kingdom",
    attr1: 5192782,
    attr2: 8918853,
  },
  {
    name: "United States",
    attr1: 22641887,
    attr2: 46081458,
  },
];


      const margin = { top: 30, right: 80, bottom: 30, left: 60 };
      const width = 600 - margin.left - margin.right;
      const height = 800 - margin.top - margin.bottom;

      const svg = d3
        .select('#shein')
        .append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);


      // Define the dimensions (attributes) you want to visualize
      const dimensions = Object.keys(data[0]).filter(key => key !== 'name');

      // Set a consistent domain for all dimensions
      const commonDomain = [d3.max(data, d => d.attr2), 0]; // Adjust the domain based on your data range

      const customTickValues = [0, 15000000, 30000000, 45000000, 60000000];

      const customTickFormat = d3.formatPrefix(".0", 1e6);

      let dotDim = d3.scaleLinear()
          .domain(commonDomain)
          .range([0, height / 2]);


      // Create X scales for the left and right axes
      const xLeft = {};
      const xRight = {};
      dimensions.forEach((dim, i) => {
        xLeft[dim] = d3.scaleLinear()
          .domain(commonDomain)
          .range([0, height / 2]);

        xRight[dim] = d3.scaleLinear()
          .domain(commonDomain)
          .range([0, height / 2]);

        // svg.append('g')
        //   .attr('class', 'axis')
        //   .attr('transform', `translate(${i * (width / (dimensions.length - 1)), 0})`)
        //   .call(d3.axisLeft(xLeft[dim]));

        // svg.append('g')
        //   .attr('class', 'axis')
        //   .attr('transform', `translate(${i * (width / (dimensions.length - 1)), width})`)
        //   .call(d3.axisRight(xRight[dim]));

          svg.append('g')
    .attr('class', 'axis')
    .attr('transform', `translate(${i * (width / (dimensions.length - 1)), 0})`)
    .call(d3.axisLeft(xLeft[dim]).tickValues(customTickValues).tickFormat(d => customTickFormat(d)))
    .select('.domain').remove()

    svg.selectAll('g.tick > line')
    .attr('x2', width); // Extend the tick lines to span the entire chart






      });

      // Create a line generator for each data point
      const line = d3.line()
        .x((d, i) => i * (width / (dimensions.length - 1)))
        .y((d, i) => i < 3 ? xLeft[dimensions[i]](d) : xRight[dimensions[i]](d));

        const hoverText = svg.append('text')
        .attr('class', 'hover-text')
        .attr('x', width / 2)
        .style('text-anchor', 'middle')
        .style('font-size', '12px')
        .style('display', 'none'); // Initially hide the hover text


        let startCircles, endCircles;

      // Draw the lines
      const lines = svg.selectAll('.line')
        .data(data)
        .enter()
        .append('path')
        .attr('class', 'line')
        .attr('d', d => line(dimensions.map(dim => d[dim])))
        .style('stroke', "#E45E00")
        .on('mouseover', function (event, d) {

          lines.style('opacity', 0.3);

          startCircles.style('opacity', 0.3);

          endCircles.style('opacity', 0.3);

          // Highlight the hovered line
          d3.select(this).style('opacity', 1);
          d3.selectAll(`circle.${d.name.replace(' ','.')}`).style('opacity', 1);

          // Calculate the y-position based on whether the line is on the left or right axis
          const yPosition = event.target.classList.contains('line-left') ? xLeft[dimensions[dimensions.length - 1]](d[dimensions[dimensions.length - 1]]) - 10 : xRight[dimensions[dimensions.length - 1]](d[dimensions[dimensions.length - 1]]) - 10;

          // Show the name when hovering over the line
          hoverText
            .attr('y', yPosition)
            .text(d.name)
            .style('display', 'block');
        })
        .on('mouseout', function () {
          // Remove the name when not hovering over the line
          lines.style('opacity', 1);
          startCircles.style('opacity', 1);
          endCircles.style('opacity', 1);
          hoverText.style('display', 'none');
        });


// Redraw the circles at the start and end of the lines
startCircles = svg.selectAll('.circle-start')
  .data(data)
  .enter()
  .append('circle')
  .attr('class', 'circle-start')
  .attr('class', d => d.name)
  .attr('cx', d => 0) // X position at the start of the line
  .attr('cy', d => dotDim(d.attr1)) // Y position at the start of the line
  .attr('r', 4) // Radius of the circle
  .style('fill', '#E45E00'); // Fill color of the circle

endCircles =svg.selectAll('.circle-end')
  .data(data)
  .enter()
  .append('circle')
  .attr('class', 'circle-end')
  .attr('class', d => d.name)
  .attr('cx', width) // X position at the start of the line
  .attr('cy', d => dotDim(d.attr2)) // Y position at the start of the line
  .attr('r', 4) // Radius of the circle
  .style('fill', '#E45E00'); // Fill color of the circle







      

    </script>
  </body>
</html>
